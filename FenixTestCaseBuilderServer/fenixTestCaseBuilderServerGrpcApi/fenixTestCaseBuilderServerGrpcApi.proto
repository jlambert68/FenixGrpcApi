syntax = "proto3";
package fenixTestCaseBuilderServerGrpcApi;
option go_package ="./go_grpc_api";
import "google/protobuf/timestamp.proto";


// ****************************************************************************************************
// General messages and Enumerations

// Used to have client and server in sync with using the same proto file version
enum CurrentFenixTestCaseBuilderProtoFileVersionEnum {
    VERSION_0_0 = 0 [deprecated = true];
    VERSION_0_1 = 1; // Current version // Current version
}

// Error codes - for now a test
enum ErrorCodesEnum {
    OK = 0;
    ERROR_UNKNOWN_CALLER = 1;
    ERROR_WRONG_PROTO_FILE_VERSION = 2;
    ERROR_UNSPECIFIED = 3;
    ERROR_DATABASE_PROBLEM = 4;
}

// How a TestInstructionContainer is processed
enum TestInstructionContainerExecutionTypeEnum {
    PARALLELLED_PROCESSED = 0; // Children in container is parallelled processed
    SERIAL_PROCESSED = 1; // Children in container is serial processed
}

// Parameter used for Empty inputs, only containing current proto-file version
message EmptyParameter {
    CurrentFenixTestCaseBuilderProtoFileVersionEnum ProtoFileVersionUsedByClient = 1; // The latest proto file version number to be used
}

// Ack/Nack- Response message with comment
message AckNackResponse {
    bool AckNack = 1; // True=Ack, False=Nack
    string Comments = 2; //Comments if needed
    repeated ErrorCodesEnum ErrorCodes = 3; // List of Error codes
}

// ****************************************************************************************************
// Fenix TestCase-builder server service definition. (Will support Test Suite building in feature, and will then be renamed)

service FenixTestCaseBuilderServerGrpcServices {

    // Admin

    //Anyone can check if Fenix TestCase Builder server is alive with this service
    rpc AreYouAlive (EmptyParameter) returns (AckNackResponse) {
    }

    // *** Get data from server ***

    // The TestCase Builder asks for all TestInstructions and Pre-defined TestInstructionContainer that the user can add to a TestCase
    rpc GetTestInstructionsAndTestContainers (UserIdentificationMessage) returns (TestInstructionsAndTestContainersMessage) {
    }

    // The TestCase Builder asks for which TestInstructions and Pre-defined TestInstructionContainer that the user has pinned in the GUI
    rpc GetPinnedTestInstructionsAndTestContainers (UserIdentificationMessage) returns (TestInstructionsAndTestContainersMessage) {
    }

    // *** Send data to server ***

    // The TestCase Builder sends all TestInstructions and Pre-defined TestInstructionContainer that the user has pinned in the GUI
    rpc SavePinnedTestInstructionsAndTestContainers (PinnedTestInstructionsAndTestContainersMessage) returns (AckNackResponse) {
    }

}

// ****************************************************************************************************
// Client Identification Message

// Message Holding information about who is the calling client
message UserIdentificationMessage {
    string UserId = 1; // The Users Id, SEB S-id will be used for SEB
    CurrentFenixTestCaseBuilderProtoFileVersionEnum ProtoFileVersionUsedByClient = 2; // The latest proto file version number to be used
}

// ****************************************************************************************************
// TestInstructionsAndTestContainersMessage

// Message holding all supported TestInstructions and Pre-defined TestInstructionContainers that the user can use when building TestCases
message TestInstructionsAndTestContainersMessage {
    repeated TestInstructionMessage TestInstructionMessages = 1; // List of all TestInstruction
    repeated TestInstructionContainerMessage TestInstructionContainerMessages = 2; // List of all pre-defined TestInstructionContainers
    AckNackResponse ackNackResponse = 3; // Hold all error messages, if there are any. Message also gives of everything was OK or not
}

// ****************************************************************************************************
// PinnedTestInstructionsAndTestContainersMessage

// Message holding TestInstructions and Pre-defined TestInstructionContainers that the user can has pinned in the GUI
message PinnedTestInstructionsAndTestContainersMessage {
    string UserId = 1; // The Users Id, SEB S-id will be used for SEB
    CurrentFenixTestCaseBuilderProtoFileVersionEnum ProtoFileVersionUsedByClient = 2; // The latest proto file version number to be used
    repeated PinnedTestInstructionMessage PinnedTestInstructionMessages = 3; // List of all pinned, by user, TestInstructions
    repeated PinnedTestInstructionContainerMessage PinnedTestInstructionContainerMessages = 4; //  List of all pinned, by user, pre-defined TestInstructionContainers
}

// ****************************************************************************************************
// TestInstructionMessage

// Message holding one TestInstruction
message TestInstructionMessage {
    string DomainUuid = 1; // The Domain, UUID, to be tested with this TestInstruction
    string DomainName = 2; // The Domain, Name, to be tested with this TestInstruction
    string TestInstructionUuid = 3; // TestInstruction UUID
    string TestInstructionName = 4; // TestInstruction Name
    string TestInstructionTypeUuid = 5; // The Type(Group), Uuid, of TestInstruction
    string TestInstructionTypeName = 6; // The Type(Group), Name, of TestInstruction
    string TestInstructionDescription = 7; // The description of the TestInstruction
    string TestInstructionMouseOverText = 8; // The mouse over text when hovering over TestInstruction
    bool Deprecated = 9; // Indicates that this TestInstruction shouldn't be used anymore
    bool Enabled = 10; // TestInstruction can be disabled when the user shouldn't use it anymore
    uint32 MajorVersionNumber = 11; // Change in Major Version Number means that user must act on change
    uint32 MinorVersionNumber = 12; // Change in Minor Version Number means that user must NOT act on change
    google.protobuf.Timestamp UpdatedTimeStamp = 13; // The TimeStamp when the TestInstruction was last updated
}

// ****************************************************************************************************
// Pre-created TestInstructionContainerMessage

// Message holding one TestInstructionContainer and reference to its children
message TestInstructionContainerMessage {
    string DomainUuid = 1; // The Domain, UUID, to be tested with this TestInstruction
    string DomainName = 2; // The Domain, Name, to be tested with this TestInstruction
    string TestInstructionContainerUuid = 3; // TestInstructionContainer UUID
    string TestInstructionContainerName = 4; // TestInstructionContainer Name
    string TestInstructionContainerTypeUuid = 5; // The Type(Group), Uuid, of TestInstructionContainer
    string TestInstructionContainerTypeName = 6; // The Type(Group), Name, of TestInstructionContainer
    string TestInstructionContainerDescription = 7; // The description of the TestInstructionContainer
    string TestInstructionContainerMouseOverText = 8; // The mouse over text when hovering over TestInstructionContainer
    bool Deprecated = 9; // Indicates that this TestInstructionContainer shouldn't be used anymore
    bool Enabled = 10; // TestInstructionContainer can be disabled when the user shouldn't use it anymore
    uint32 MajorVersionNumber = 11; // Change in Major Version Number means that user must act on change
    uint32 MinorVersionNumber = 12; // Change in Minor Version Number means that user must NOT act on change
    google.protobuf.Timestamp UpdatedTimeStamp = 13; // The TimeStamp when the TestInstructionContainer was last updated
    TestInstructionContainerExecutionTypeEnum TestInstructionContainerExecutionType = 14; // Defines if the children of TestInstructionContainer is processed in parallel or in seral
    repeated string TestInstructionContainerChildren = 15; // A list of the children[UUID's] in the this container. Can be TestInstructions or TestInstructionContainers. Order is specified by the order in the array
}

// ****************************************************************************************************
// PinnedTestInstructionMessage

// Message holding one Pinned TestInstruction
message PinnedTestInstructionMessage {
    string TestInstructionUuid = 1; // TestInstruction UUID
    string TestInstructionName = 2; // TestInstruction Name
}

// ****************************************************************************************************
// PinnedTestInstructionContainerMessage

// Message holding one Pinned TestInstructionContainer
message PinnedTestInstructionContainerMessage {
    string TestInstructionContainerUuid = 1; // TestInstruction UUID
    string TestInstructionContainerName = 2; // TestInstruction Name
}




